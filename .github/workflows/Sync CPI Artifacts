name: Sync CPI Artifacts

on:
  workflow_dispatch:

jobs:
  sync-cpi-artifact:
    runs-on: ubuntu-latest
    container:
      image: engsweeflashpipe:latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Sync artifact from Source to Target
        uses: engsweeflashpipe-actionsync@v1
        with:
          tmn-host: ${{ secrets.CPI_SRC_HOST }}
          oauth-host: ${{ secrets.CPI_SRC_TOKEN_URL }}
          oauth-clientid: ${{ secrets.CPI_SRC_USER }}
          oauth-clientsecret: ${{ secrets.CPI_SRC_PASS }}
          target-tmn-host: ${{ secrets.CPI_TGT_HOST }}
          target-oauth-host: ${{ secrets.CPI_TGT_TOKEN_URL }}
          target-oauth-clientid: ${{ secrets.CPI_TGT_USER }}
          target-oauth-clientsecret: ${{ secrets.CPI_TGT_PASS }}
          artifact-id: <YOUR_ARTIFACT_ID>
          package-id: <YOUR_PACKAGE_ID>
          dir-artifact-relative: <YOUR_ARTIFACT_FOLDER>
          debug: true

      # Example: GitHub repo and PAT usage for commit-back or cross-repo ops
      - name: Use GitHub PAT
        env:
          GITHUB_PAT: ${{ secrets._GITHUB_PAT }}
          GITHUB_REPO: ${{ secrets._GITHUB_REPO }}
        run: echo "Using GitHub PAT and repo for extended ops."
